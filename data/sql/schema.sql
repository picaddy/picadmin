CREATE TABLE bug (id BIGINT AUTO_INCREMENT, bug_url VARCHAR(255) NOT NULL, bug_description TEXT NOT NULL, bug_auteur_id BIGINT NOT NULL, bug_referent_id BIGINT NOT NULL, bug_statut_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX bug_referent_id_idx (bug_referent_id), INDEX bug_statut_id_idx (bug_statut_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE commentaire (id BIGINT AUTO_INCREMENT, commentaire_description TEXT NOT NULL, commentaire_idee_id BIGINT NOT NULL, commentaire_tache_id BIGINT NOT NULL, commentaire_bug_id BIGINT NOT NULL, commentaire_utilisateur_id BIGINT NOT NULL, commentaire_parent_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX commentaire_utilisateur_id_idx (commentaire_utilisateur_id), INDEX commentaire_tache_id_idx (commentaire_tache_id), INDEX commentaire_idee_id_idx (commentaire_idee_id), INDEX commentaire_bug_id_idx (commentaire_bug_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE document (id BIGINT AUTO_INCREMENT, document_nom VARCHAR(255) NOT NULL, document_projet_id BIGINT NOT NULL, document_tache_id BIGINT NOT NULL, document_idee_id BIGINT NOT NULL, document_bug_id BIGINT NOT NULL, document_utilisateur_id BIGINT NOT NULL, INDEX document_projet_id_idx (document_projet_id), INDEX document_tache_id_idx (document_tache_id), INDEX document_idee_id_idx (document_idee_id), INDEX document_bug_id_idx (document_bug_id), INDEX document_utilisateur_id_idx (document_utilisateur_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE groupe (id BIGINT AUTO_INCREMENT, groupe_nom VARCHAR(255) NOT NULL UNIQUE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE idee (id BIGINT AUTO_INCREMENT, idee_nom VARCHAR(255) NOT NULL, idee_description TEXT NOT NULL, idee_utilisateur_id BIGINT NOT NULL, idee_projet_id BIGINT NOT NULL, idee_statut_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX idee_utilisateur_id_idx (idee_utilisateur_id), INDEX idee_projet_id_idx (idee_projet_id), INDEX idee_statut_id_idx (idee_statut_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE note (id BIGINT AUTO_INCREMENT, note_nom VARCHAR(255) NOT NULL, note_description TEXT NOT NULL, note_utilisateur_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX note_utilisateur_id_idx (note_utilisateur_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE projet (id BIGINT AUTO_INCREMENT, projet_nom VARCHAR(255) NOT NULL UNIQUE, projet_description TEXT, projet_date_debut DATETIME NOT NULL, projet_date_fin DATETIME NOT NULL, projet_type_id BIGINT NOT NULL, projet_statut_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX projet_type_id_idx (projet_type_id), INDEX projet_statut_id_idx (projet_statut_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE projet_to_utilisateur (projet_id BIGINT, utilisateur_id BIGINT, PRIMARY KEY(projet_id, utilisateur_id)) ENGINE = INNODB;
CREATE TABLE projet_type (id BIGINT AUTO_INCREMENT, projet_type_nom VARCHAR(255) NOT NULL UNIQUE, projet_type_code VARCHAR(1) NOT NULL, projet_type_couleur VARCHAR(6) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE statut (id BIGINT AUTO_INCREMENT, statut_nom VARCHAR(255) NOT NULL, statut_code VARCHAR(1) NOT NULL, statut_couleur VARCHAR(6) NOT NULL, statut_bug BIGINT NOT NULL, statut_idee BIGINT NOT NULL, statut_tache BIGINT NOT NULL, statut_projet BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE tache (id BIGINT AUTO_INCREMENT, tache_nom VARCHAR(255) NOT NULL UNIQUE, tache_description TEXT, tache_date_debut DATETIME NOT NULL, tache_date_fin DATETIME NOT NULL, tache_parent_id BIGINT NOT NULL, tache_ordre BIGINT NOT NULL, tache_pourcentage BIGINT NOT NULL, tache_projet_id BIGINT NOT NULL, tache_statut_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tache_projet_id_idx (tache_projet_id), INDEX tache_statut_id_idx (tache_statut_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE tache_to_utilisateur (tache_id BIGINT, utilisateur_id BIGINT, PRIMARY KEY(tache_id, utilisateur_id)) ENGINE = INNODB;
CREATE TABLE utilisateur (id BIGINT AUTO_INCREMENT, utilisateur_nom VARCHAR(255) NOT NULL, utilisateur_prenom VARCHAR(255) NOT NULL, utilisateur_email VARCHAR(255) NOT NULL UNIQUE, utilisateur_pseudo VARCHAR(255) NOT NULL, utilisateur_motdepasse VARCHAR(255) NOT NULL, utilisateur_photo VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE utilisateur_to_groupe (utilisateur_id BIGINT, groupe_id BIGINT, PRIMARY KEY(utilisateur_id, groupe_id)) ENGINE = INNODB;
ALTER TABLE bug ADD CONSTRAINT bug_bug_statut_id_statut_id FOREIGN KEY (bug_statut_id) REFERENCES statut(id) ON DELETE CASCADE;
ALTER TABLE bug ADD CONSTRAINT bug_bug_referent_id_utilisateur_id FOREIGN KEY (bug_referent_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE commentaire ADD CONSTRAINT commentaire_commentaire_utilisateur_id_utilisateur_id FOREIGN KEY (commentaire_utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE commentaire ADD CONSTRAINT commentaire_commentaire_tache_id_tache_id FOREIGN KEY (commentaire_tache_id) REFERENCES tache(id) ON DELETE CASCADE;
ALTER TABLE commentaire ADD CONSTRAINT commentaire_commentaire_idee_id_idee_id FOREIGN KEY (commentaire_idee_id) REFERENCES idee(id) ON DELETE CASCADE;
ALTER TABLE commentaire ADD CONSTRAINT commentaire_commentaire_bug_id_bug_id FOREIGN KEY (commentaire_bug_id) REFERENCES bug(id) ON DELETE CASCADE;
ALTER TABLE document ADD CONSTRAINT document_document_utilisateur_id_utilisateur_id FOREIGN KEY (document_utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE document ADD CONSTRAINT document_document_tache_id_tache_id FOREIGN KEY (document_tache_id) REFERENCES tache(id) ON DELETE CASCADE;
ALTER TABLE document ADD CONSTRAINT document_document_projet_id_projet_id FOREIGN KEY (document_projet_id) REFERENCES projet(id) ON DELETE CASCADE;
ALTER TABLE document ADD CONSTRAINT document_document_idee_id_idee_id FOREIGN KEY (document_idee_id) REFERENCES idee(id) ON DELETE CASCADE;
ALTER TABLE document ADD CONSTRAINT document_document_bug_id_bug_id FOREIGN KEY (document_bug_id) REFERENCES bug(id) ON DELETE CASCADE;
ALTER TABLE idee ADD CONSTRAINT idee_idee_utilisateur_id_utilisateur_id FOREIGN KEY (idee_utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE idee ADD CONSTRAINT idee_idee_statut_id_statut_id FOREIGN KEY (idee_statut_id) REFERENCES statut(id) ON DELETE CASCADE;
ALTER TABLE idee ADD CONSTRAINT idee_idee_projet_id_projet_id FOREIGN KEY (idee_projet_id) REFERENCES projet(id) ON DELETE CASCADE;
ALTER TABLE note ADD CONSTRAINT note_note_utilisateur_id_utilisateur_id FOREIGN KEY (note_utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE projet ADD CONSTRAINT projet_projet_type_id_projet_type_id FOREIGN KEY (projet_type_id) REFERENCES projet_type(id) ON DELETE CASCADE;
ALTER TABLE projet ADD CONSTRAINT projet_projet_statut_id_statut_id FOREIGN KEY (projet_statut_id) REFERENCES statut(id) ON DELETE CASCADE;
ALTER TABLE projet_to_utilisateur ADD CONSTRAINT projet_to_utilisateur_utilisateur_id_utilisateur_id FOREIGN KEY (utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE projet_to_utilisateur ADD CONSTRAINT projet_to_utilisateur_projet_id_projet_id FOREIGN KEY (projet_id) REFERENCES projet(id) ON DELETE CASCADE;
ALTER TABLE tache ADD CONSTRAINT tache_tache_statut_id_statut_id FOREIGN KEY (tache_statut_id) REFERENCES statut(id) ON DELETE CASCADE;
ALTER TABLE tache ADD CONSTRAINT tache_tache_projet_id_projet_id FOREIGN KEY (tache_projet_id) REFERENCES projet(id) ON DELETE CASCADE;
ALTER TABLE tache_to_utilisateur ADD CONSTRAINT tache_to_utilisateur_utilisateur_id_utilisateur_id FOREIGN KEY (utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE tache_to_utilisateur ADD CONSTRAINT tache_to_utilisateur_tache_id_tache_id FOREIGN KEY (tache_id) REFERENCES tache(id) ON DELETE CASCADE;
ALTER TABLE utilisateur_to_groupe ADD CONSTRAINT utilisateur_to_groupe_utilisateur_id_utilisateur_id FOREIGN KEY (utilisateur_id) REFERENCES utilisateur(id) ON DELETE CASCADE;
ALTER TABLE utilisateur_to_groupe ADD CONSTRAINT utilisateur_to_groupe_groupe_id_groupe_id FOREIGN KEY (groupe_id) REFERENCES groupe(id) ON DELETE CASCADE;
